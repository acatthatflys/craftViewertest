{"version":3,"sources":["src/part.js"],"names":[],"mappings":"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","file":"src/part.js","sourcesContent":["const parts = require('./build/stockParts.json');\r\n\r\nclass Part {\r\n\t\r\n\tconstructor(data, name) {\r\n\r\n\t\tthis.name = name;\r\n\r\n\t\tthis.pos = data.pos.split(',');\r\n\r\n\t\tthis.rot = data.rot.split(',');\r\n\t}\r\n\r\n\t//Handles lhs => rhs\r\n\t//http://answers.unity3d.com/storage/temp/12048-lefthandedtorighthanded.pdf\r\n\tposVec(vec){\r\n\t\tvec = [for (v of vec) parseFloat(v)];\r\n\t\tconst vec3 = new THREE.Vector3(vec[0], vec[1], vec[2]);\r\n\t\tvec3.setZ(-1.0*vec3.z);\r\n\t\treturn vec3\r\n\t\t// return new THREE.Vector3(vec[0], vec[1], vec[2]);\r\n\t}\r\n\tscaleVec(vec){\r\n\t\treturn new THREE.Vector3(vec[0], vec[1], vec[2]);\r\n\t}\r\n\trotQuat(quat) {\r\n\t\tconsole.log('quat');\r\n\t\tconsole.log(quat);\r\n\t\tquat = [for (q of quat) parseFloat(q)];\r\n\t\tconsole.log(quat);\r\n\t\tlet rot = new THREE.Quaternion(quat[0], quat[1], quat[2], quat[3]);\r\n\t\trot = new THREE.Matrix4().makeRotationFromQuaternion(rot);\r\n\t\trot.elements[2] = -1.0*rot.elements[2]\r\n\t\trot.elements[6] = -1.0*rot.elements[6]\r\n\t\trot.elements[8] = -1.0*rot.elements[8]\r\n\t\trot.elements[9] = -1.0*rot.elements[9]\r\n\t\treturn new THREE.Quaternion().setFromRotationMatrix(rot);\r\n\t\t// quat = new THREE.Quaternion(quat[2], quat[3], quat[0], quat[1]);\r\n\t\t// console.log(quat);\r\n\t\t// return quat;\r\n\t\t// let q = new THREE.Quaternion(-1.0*quat[0], quat[1], quat[2], -1.0*quat[3]);\r\n\t\t// // var q = new THREE.Quaternion( -qx, qy, qz, -qw );\r\n\r\n\t\t// let v = new THREE.Euler();  \r\n\t\t// v.setFromQuaternion( q );\r\n\r\n\t\t// v.y += Math.PI; // Y is 180 degrees off\r\n\r\n\t\t// v.z *= -1; // flip Z\r\n\t\t// return q.setFromEuler(v);\r\n\r\n\t}\r\n\r\n\tthreeVec(vec){\r\n\t\t// const v = THREE.Vector3(vec[0], vec[1], vec[2]);\r\n\t\tvec = [for (v of vec) parseFloat(v)];\r\n\t\tconst vec3 = new THREE.Vector3(-1.0*vec[0], vec[1], vec[2]);\r\n\t\t// vec3.setZ(-1.0*vec3.z);\r\n\t\treturn vec3\r\n\t}\r\n\r\n\r\n\tcreateSubMesh(model, parent){\r\n\t\tlet mesh;\r\n\t\tif (model.verts.length == 0) {\r\n\t\t\tmesh = new THREE.Object3D();\r\n\t\t} else {\r\n\t\t\t\r\n\t\t\tconst geometry = new THREE.Geometry();\r\n\t\t\tfor (let v of model.verts){\r\n\t\t\t\tgeometry.vertices.push(this.threeVec(v));\r\n\t\t\t}\r\n\t\t\tfor (let f of model.faces){\r\n\t\t\t\tgeometry.faces.push( new THREE.Face3(f[0], f[1], f[2]))\r\n\t\t\t}\r\n\t\t\tmesh = new THREE.Mesh(geometry);\r\n\t\t}\r\n\r\n\t\tparent.add(mesh)\r\n\t\t\r\n\t\tmodel.localScale = [for (rot of model.localScale) parseFloat(rot)];\r\n\t\tmesh.scale.set(model.localScale[0], model.localScale[1], model.localScale[2]);\r\n\t\t// mesh.quaternion.set(this.rotQuat(model.localRot));\r\n\t\t// mesh.position.set(this.posVec(model.localPos));\r\n\t\tmodel.localRot = [for (rot of model.localRot) parseFloat(rot)];\r\n\t\tmesh.quaternion.set(model.localRot[0], model.localRot[1], model.localRot[2], model.localRot[3]);\r\n\t\tmodel.localPos = [for (rot of model.localPos) parseFloat(rot)];\r\n\t\tmesh.position.set(model.localPos[0], model.localPos[1], model.localPos[2]);\r\n\t\t\r\n\t\t// console.log(mesh.position);\r\n\t\t// console.log(mesh.scale);\r\n\r\n\t\tfor (let child of model.children) {\r\n\t\t\tthis.createSubMesh(child, mesh);\r\n\t\t}\r\n\t}\r\n\r\n\tcreateMesh(model, parent){\r\n\t\tif (model.collider) { return; }\r\n\t\tlet mesh;\r\n\t\tif (model.verts.length == 0) {\r\n\t\t\tmesh = new THREE.Object3D();\r\n\t\t} else {\r\n\t\t\tconst geometry = new THREE.Geometry();\r\n\t\t\tfor (let v of model.verts){\r\n\t\t\t\tgeometry.vertices.push(this.threeVec(v));\r\n\t\t\t}\r\n\t\t\tfor (let f of model.faces){\r\n\t\t\t\tgeometry.faces.push( new THREE.Face3(f[0], f[1], f[2]))\r\n\t\t\t}\r\n\t\t\tmesh = new THREE.Mesh(geometry);\r\n\t\t}\r\n\t\t\r\n\t\tmodel.localScale = [for (rot of model.localScale) parseFloat(rot)];\r\n\t\tmesh.scale.set(model.localScale[0], model.localScale[1], model.localScale[2]);\r\n\t\t// mesh.quaternion.set(this.rotQuat(model.localRot));\r\n\t\t// mesh.position.set(this.posVec(model.localPos));\r\n\t\tmodel.localRot = [for (rot of model.localRot) parseFloat(rot)];\r\n\t\tmesh.quaternion.set(model.localRot[0], model.localRot[1], model.localRot[2], model.localRot[3]);\r\n\t\tmodel.localPos = [for (rot of model.localPos) parseFloat(rot)];\r\n\t\tmesh.position.set(model.localPos[0], model.localPos[1], model.localPos[2]);\r\n\r\n\r\n\t\tthis.mesh = mesh;\r\n\t\tparent.add(this.mesh);\r\n\r\n\t\tfor (let child of model.children) {\r\n\t\t\tthis.createSubMesh(child, this.mesh);\r\n\t\t}\r\n\t\t\r\n\t\t// mesh.rotation.x -= 90;\r\n\t\tthis.mesh.quaternion.multiply(this.rotQuat((this.rot)));\r\n\t\t// mesh.scale\r\n\t\tthis.mesh.position.copy(this.posVec(this.pos));\r\n\t}\r\n\r\n\r\n\tload(parent, cb) {\r\n\t\tlet muPath = 'E:\\\\Program Files\\\\Steam\\\\steamapps\\\\common\\\\Kerbal Space Program' + parts[this.name]; \r\n\t\tlet options = {\r\n\t\t\t\tscriptPath: 'E:\\\\projects\\\\CraftViewer\\\\',\r\n\t\t\t\targs:[muPath]\r\n\t\t};\r\n\t\tPythonShell.run('muParser.py', options, (err, results) => {\r\n\t\t\t// console.log(err);\r\n\t\t\t// console.log(results);\r\n\t\t\tif (err) {\r\n\t\t\t\tconsole.log('ee');\r\n\t\t\t\tcb(err);\r\n\t\t\t} else {\r\n\t\t\t\t// console.log(JSON.parse(results[0]));\r\n\t\t\t\tthis.createMesh(JSON.parse(results[0]), parent);\r\n\t\t\t\t// this.info = craft.VESSEL;\r\n\t\t\t\t// this.parts = _.omit(craft, 'VESSEL');\r\n\t\t\t\tcb(false);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\nclass CompoundPart extends Part {\r\n\t\r\n\tconstructor(data, name) {\r\n\r\n\t\tsuper(data, name);\r\n\t}\r\n}"]}