{"version":3,"sources":["src/part.js"],"names":[],"mappings":"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","file":"src/part.js","sourcesContent":["const parts = require('./build/stockParts.json');\n\nclass Part {\n\t\n\tconstructor(data, name) {\n\n\t\tthis.name = name;\n\n\t\tthis.pos = data.pos.split(',');\n\t\tthis.pos = [for (v of this.pos) parseFloat(v)];\n\n\t\tthis.rot = data.rot.split(',');\n\t\tthis.rot = [for (v of this.rot) parseFloat(v)];\n\t}\n\n\t//Handles lhs => rhs\n\t//http://answers.unity3d.com/storage/temp/12048-lefthandedtorighthanded.pdf\n\tposVec(vec){\n\t\tvec = [for (v of vec) parseFloat(v)];\n\t\tconst vec3 = new THREE.Vector3(vec[0], vec[1], vec[2]);\n\t\t// vec3.setZ(-1.0*vec3.z);\n\t\treturn vec3\n\t\t// return new THREE.Vector3(vec[0], vec[1], vec[2]);\n\t}\n\tscaleVec(vec){\n\t\treturn new THREE.Vector3(vec[0], vec[1], vec[2]);\n\t}\n\trhsVec3(vec) {\n\t\treturn new THREE.Vector3(vec[0], vec[1], -vec[2]);\n\t}\n\trhsQuat(quat) {\n\t\t// return new THREE.Quaternion(quat[2], quat[3], quat[0], quat[1]);\n\t\t// return new THREE.Quaternion(quat[0], quat[1], quat[2], quat[3]);\n\t\tlet rot = new THREE.Quaternion(quat[0], quat[1], quat[2], quat[3]);\n\t\trot = new THREE.Matrix4().makeRotationFromQuaternion(rot);\n\t\trot.elements[2] = -1.0*rot.elements[2]\n\t\trot.elements[6] = -1.0*rot.elements[6]\n\t\trot.elements[8] = -1.0*rot.elements[8]\n\t\trot.elements[9] = -1.0*rot.elements[9]\n\t\treturn new THREE.Quaternion().setFromRotationMatrix(rot);\n\t}\n\trotQuat(quat) {\n\t\tconsole.log('quat');\n\t\tconsole.log(quat);\n\t\tquat = [for (q of quat) parseFloat(q)];\n\t\tconsole.log(quat);\n\t\t// quat = new THREE.Quaternion(quat[2], quat[3], quat[0], quat[1]);\n\t\t// console.log(quat);\n\t\t// return quat;\n\t\t// let q = new THREE.Quaternion(-1.0*quat[0], quat[1], quat[2], -1.0*quat[3]);\n\t\t// // var q = new THREE.Quaternion( -qx, qy, qz, -qw );\n\n\t\t// let v = new THREE.Euler();  \n\t\t// v.setFromQuaternion( q );\n\n\t\t// v.y += Math.PI; // Y is 180 degrees off\n\n\t\t// v.z *= -1; // flip Z\n\t\t// return q.setFromEuler(v);\n\n\t}\n\n\tvec3(vec){\n\t\t// const v = new THREE.Vector3(vec[0], vec[1], vec[2]);\n\t\t// vec = [for (v of vec) parseFloat(v)];\n\t\t// const vec3 = new THREE.Vector3(-1.0*vec[0], vec[1], vec[2]);\n\t\t// vec3.setZ(-1.0*vec3.z);\n\n\t\treturn new THREE.Vector3(vec[0], vec[1], vec[2]);\n\t}\n\n\tface3(f) {\n\t\treturn new THREE.Face3(f[0], f[1], f[2])\n\t}\n\n\n\n\tcreateMeshObj(geometry, model) {\n\t\tlet mesh\n\t\tif (!geometry) {\n\t\t\tmesh = new THREE.Object3D();\n\t\t}\n\n\t}\n\n\n\n\tcreateSubMesh(model, parent){\n\t\tlet mesh;\n\t\tif (model.verts.length == 0 || model.collider) {\n\t\t\tmesh = new THREE.Object3D();\n\t\t} else {\n\t\t\t\n\t\t\tconst geometry = new THREE.Geometry();\n\t\t\tfor (let v of model.verts){\n\t\t\t\tgeometry.vertices.push(this.vec3(v));\n\t\t\t}\n\t\t\tfor (let f of model.faces){\n\t\t\t\tgeometry.faces.push(this.face3(f))\n\t\t\t}\n\t\t\tmesh = new THREE.Mesh(geometry);\n\t\t}\n\n\t\t\n\t\tmodel.localScale = [for (rot of model.localScale) parseFloat(rot)];\n\t\tmesh.scale.set(model.localScale[0], model.localScale[1], model.localScale[2]);\n\t\t// mesh.quaternion.set(this.rotQuat(model.localRot));\n\t\t// mesh.position.set(this.posVec(model.localPos));\n\t\tmodel.localRot = [for (rot of model.localRot) parseFloat(rot)];\n\t\tmesh.quaternion.set(model.localRot[0], model.localRot[1], model.localRot[2], model.localRot[3]);\n\t\tmodel.localPos = [for (rot of model.localPos) parseFloat(rot)];\n\t\tmesh.position.set(model.localPos[0], model.localPos[1], model.localPos[2]);\n\t\t\n\t\t// console.log(mesh.position);\n\t\t// console.log(mesh.scale);\n\n\t\tparent.add(mesh)\n\t\tfor (let child of model.children) {\n\t\t\tthis.createSubMesh(child, mesh);\n\t\t}\n\t}\n\n\tcreateGeometry(model) {\n\t\tconst geometry = new THREE.Geometry();\n\t\tfor (let v of model.verts){\n\t\t\tgeometry.vertices.push(this.vec3(v));\n\t\t}\n\t\tfor (let f of model.faces){\n\t\t\tgeometry.faces.push(this.face3(f));\n\t\t}\n\t\treturn geometry;\n\t}\n\n\tcreateMaterial(model) {\n\t\treturn new THREE.MeshPhongMaterial( { color: 0xdddddd, specular: 0x009900, shininess: 30, shading: THREE.FlatShading, side:THREE.BackSide} );\n\t\t// return new THREE.MeshPhongMaterial( {color:0xdddddd, side:THREE.DoubleSide} );\n\t}\n\n\n\tcreateMesh(model, parent, root=null){\n\t\t// let geo = createGeometry(model);\n\t\t// let mat = createMat(model);\n\t\tlet mesh;\n\t\tif (model.verts.length == 0 || model.collider) {\n\t\t\tmesh = new THREE.Object3D();\n\t\t} else {\n\t\t\tconst geometry = this.createGeometry(model);\n\t\t\tconst material = this.createMaterial(model);\n\t\t\tmesh = new THREE.Mesh(geometry, material);\n\t\t}\n\t\t\n\t\tmodel.localScale = [for (rot of model.localScale) parseFloat(rot)];\n\t\tmesh.scale.set(model.localScale[0], model.localScale[1], model.localScale[2]);\n\t\tmodel.localRot = [for (rot of model.localRot) parseFloat(rot)];\n\t\tmesh.quaternion.set(model.localRot[0], model.localRot[1], model.localRot[2], model.localRot[3]);\n\t\tmodel.localPos = [for (rot of model.localPos) parseFloat(rot)];\n\t\tmesh.position.set(model.localPos[0], model.localPos[1], model.localPos[2]);\n\n\t\tparent.add(mesh);\n\n\t\tfor (let child of model.children) {\n\t\t\tthis.createMesh(child, mesh);\n\t\t}\n\t\t\n\t\tif (root) this.mesh = mesh;\n\n\t\t// mesh.rotation.x -= 90;\n\t\t// this.mesh.quaternion.multiply(this.rotQuat((this.rot)));\n\t\t// mesh.scale\n\t}\n\n\n\tload(parent, cb) {\n\n\t\tfileManager.loadPart(this.name, (err, mu, partInfo) => {\n\t\t\tif (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\treturn cb(err);\n\t\t\t}\n\t\t\tthis.createMesh(mu, parent, true);\n\n\t\t\tthis.mesh.scale.set(partInfo.scale, partInfo.scale, partInfo.scale);\n\t\t\t// this.mesh.rotation.copy(this.rhsQuat(this.rot));\n\t\t\tthis.mesh.position.copy(this.rhsVec3(this.pos));\n\n\t\t\tcb();\n\t\t});\n\t}\n}\n\n\nclass CompoundPart extends Part {\n\t\n\tconstructor(data, name) {\n\n\t\tsuper(data, name);\n\t}\n}"]}